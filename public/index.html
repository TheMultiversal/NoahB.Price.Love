<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Noah B. Price - Author</title>
  <link rel="stylesheet" href="styles.css">
  <link rel="stylesheet" href="global.css">
  <script src="/particles.min.js"></script>
  <script src="/background-init.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/@hotwired/turbo@7.3.0/dist/turbo.min.js"></script>
  <script src="/nav.js"></script>
  <script src="/particles-mouse.js"></script>
  <script>(function(){
  // Initialize only when DOM is ready (prevents errors when scripts run in <head>)
  function _ready(fn){
    if(document.readyState === 'loading'){
      document.addEventListener('DOMContentLoaded', fn);
    } else { fn(); }
    document.addEventListener('turbo:load', fn);
  }

  _ready(function(){
    const AUDIO_BASENAME = '/uploads/site-music'; // try .mp3 first, then .m4a
    const STORAGE_KEY = 'siteAudioState';
    // Resolve available extension (.mp3 or .m4a) by probing the server once per page load
    let AUDIO_EXT = '.mp3';
    async function _detectAudioExt(){
      try{
        const res = await fetch(AUDIO_BASENAME + '.mp3', { method: 'HEAD' });
        if(res && res.ok) return '.mp3';
        const res2 = await fetch(AUDIO_BASENAME + '.m4a', { method: 'HEAD' });
        if(res2 && res2.ok) return '.m4a';
      }catch(e){}
      return '.mp3'; // fallback to .mp3 by default
    }
    function _audioSrc(){ const cb = _getCacheBuster(); return AUDIO_BASENAME + AUDIO_EXT + (cb ? '?cb=' + cb : ''); }

  // Reuse a persistent audio element if present (Turbo permanent). Create only if missing.
  let audio = document.getElementById('site-audio');
  const createdHere = !audio;

  // Helper to read a cache-buster set after upload so clients fetch the newest file
  function _getCacheBuster(){ try{ return localStorage.getItem('siteAudioCacheBuster') || ''; }catch(e){ return ''; } }
  // Resolve the current audio URL (basename + detected extension + cache-buster)
  function _audioSrc(){ const cb = _getCacheBuster(); return AUDIO_BASENAME + AUDIO_EXT + (cb ? '?cb=' + cb : ''); }

  // Ensure we detect which extension to use, then create or update the audio element
  _detectAudioExt().then(ext => {
    AUDIO_EXT = ext;
    if(!audio){
      audio = document.createElement('audio');
      audio.id = 'site-audio';
      audio.src = _audioSrc();
      audio.loop = true;
      audio.preload = 'auto';
      audio.crossOrigin = 'anonymous';
      audio.style.display = 'none';
      audio.volume = 0.9;
      // mobile-friendly attributes
      try{ audio.setAttribute('playsinline',''); audio.setAttribute('webkit-playsinline',''); audio.playsInline = true; }catch(e){}
      document.body.appendChild(audio);
    } else {
      // Ensure src points to the uploaded file (with cache-bust)
      const desiredSrc = _audioSrc();
      if(!audio.src || audio.src.indexOf(AUDIO_BASENAME) === -1 || audio.src !== desiredSrc){
        audio.src = desiredSrc;
        try{ audio.load(); }catch(e){}
      }
    }

    // If audio fails to load (extension mismatch), try the other known extension once
    audio.addEventListener('error', function onAudioError(){
      if(AUDIO_EXT === '.mp3'){
        AUDIO_EXT = '.m4a';
        audio.src = _audioSrc();
        try{ audio.load(); }catch(e){}
      }
      audio.removeEventListener('error', onAudioError);
    });
  }).catch(()=>{
    // If detection fails, proceed with default src already set above
  });

  // Ask server for the current audio file version (mtime) and update cache-buster automatically
  (function(){
    fetch('/audio-version').then(r => r.json()).then(j => {
      if(j && j.version){
        try{
          const sv = String(j.version);
          const local = String(localStorage.getItem('siteAudioCacheBuster') || '');
          if(local !== sv){
            localStorage.setItem('siteAudioCacheBuster', sv);
            const newSrc = _audioSrc();
            if(audio.src !== newSrc){
              audio.src = newSrc;
              try{ audio.load(); }catch(e){}
            }
          }
        }catch(e){}
      }
    }).catch(()=>{});
  })();

  // Helper to resume playback/unmute based on saved state. Non-blocking and tolerant of autoplay policies.
  function resumeIfNeeded(){
    try{
      const s = localStorage.getItem(STORAGE_KEY);
      if(!s) return;
      const st = JSON.parse(s);
      // Restore unmuted preference immediately if user previously unmuted
      if(st.unmuted){
        try{ audio.muted = false;}catch(e){}
      }
      // Restore time if needed
      try{ if(typeof st.time === 'number' && !isNaN(st.time)) audio.currentTime = st.time;}catch(e){}
      // If previously playing, try to play (may be blocked by browser if no gesture; that's fine)
      if(st.playing){
        audio.play().then(()=>{
          // playing resumed
          saveState();
          _updateCtlIcon();
        }).catch(()=>{
          // Could not autoplay (likely blocked) ‚Äî leave state and control for user interaction
          _updateCtlIcon();
        });
      } else {
        _updateCtlIcon();
      }
    }catch(e){ console.warn('[AudioPlayer] resumeIfNeeded failed', e);}
  }

  // If this audio element has already been initialized, avoid reattaching event listeners
  if(audio.dataset.siteAudioInitialized === '1'){
    // On re-run (new page), ensure saved desired state is respected (resume if needed)
    resumeIfNeeded();
    return;
  }

  // Also ensure we attempt resume on Turbo navigations
  document.addEventListener('turbo:load', function(){ resumeIfNeeded(); });

  audio.dataset.siteAudioInitialized = '1';

  // Floating control (visible & interactive) ‚Äî allows users to play/unmute immediately
  const ctl = document.createElement('button');

  // Prompt overlay shown until first interaction; persuades user to scroll/click for sound
  const prompt = document.createElement('div');
  prompt.id = 'audio-start-prompt';
  prompt.textContent = 'Scroll or tap anywhere to hear music';
  Object.assign(prompt.style, {
    position: 'fixed',
    top: '0',
    left: '0',
    right: '0',
    padding: '12px',
    background: 'rgba(0,0,0,0.7)',
    color: '#fff',
    textAlign: 'center',
    fontSize: '16px',
    zIndex: 2001,
    cursor: 'pointer'
  });
  document.body.appendChild(prompt);

  function hidePrompt(){
    if(prompt && prompt.parentNode) prompt.parentNode.removeChild(prompt);
  }

  startOnGesture = (function(orig){
    return function(e){
      hidePrompt();
      orig(e);
    };
  })(startOnGesture);

  ctl.id = 'site-audio-control';
  ctl.setAttribute('aria-label','Play or pause site audio');
  ctl.title = 'Play / Pause site audio';
  ctl.innerHTML = 'üîà';
  Object.assign(ctl.style, {
    position: 'fixed',
    right: '16px',
    bottom: '16px',
    zIndex: 2000,
    width: '44px',
    height: '44px',
    borderRadius: '50%',
    border: 'none',
    background: '#2c3e50',
    color: '#fff',
    cursor: 'pointer',
    display: 'flex',
    alignItems: 'center',
    justifyContent: 'center',
    fontSize: '18px',
    boxShadow: '0 2px 8px rgba(0,0,0,0.2)',
    opacity: '0.95',
    pointerEvents: 'auto'
  });
  document.body.appendChild(ctl);

  // Update button icon/text based on state
  function _updateCtlIcon(){
    try{
      if(audio.paused){
        ctl.innerHTML = '‚èµ'; // play
        ctl.title = 'Play site audio';
      } else if(audio.muted){
        ctl.innerHTML = 'üîà'; // muted
        ctl.title = 'Unmute site audio';
      } else {
        ctl.innerHTML = 'üîä'; // playing & unmuted
        ctl.title = 'Pause site audio';
      }
    }catch(e){}
  }

  // Toggle behaviour: click toggles play/pause and unmutes if muted
  ctl.addEventListener('click', function(e){
    e.preventDefault();
    try{
      if(audio.muted){
        audio.muted = false;
        saveState();
      }
      if(audio.paused){
        audio.play().then(()=>{ saveState(); _updateCtlIcon(); }).catch(()=>{ _updateCtlIcon(); });
      } else {
        audio.pause();
        saveState();
        _updateCtlIcon();
      }
    }catch(err){
      console.error('[AudioPlayer] Control click error', err);
    }
  });

  // Update icon on audio events
  audio.addEventListener('play', _updateCtlIcon);
  audio.addEventListener('pause', _updateCtlIcon);
  audio.addEventListener('volumechange', _updateCtlIcon);

  // Load saved state (includes unmuted preference)
  let state = { playing: false, time: 0, unmuted: false };
  try{ const s = localStorage.getItem(STORAGE_KEY); if(s) state = JSON.parse(s); } catch(e){}

  // Apply stored time only if we created the element here and time is available
  if(createdHere && state.time){
    try{ audio.currentTime = state.time || 0;}catch(e){}
  }

  // Apply mute/unmute preference: default to muted unless user previously unmuted
  try{
    if(state.unmuted){ audio.muted = false; } else { audio.muted = true; }
  }catch(e){}

  function saveState(){
    try{ localStorage.setItem(STORAGE_KEY, JSON.stringify({ playing: !audio.paused, time: audio.currentTime, unmuted: !audio.muted })); }catch(e){}
  }

  // Try autofocus: will only work muted
  function tryAutoPlay(){
    audio.play().then(()=>{ saveState(); }).catch(()=>{});
  }

  // Fade-in helper: ramp volume from current to target over ms
  function _fadeVolume(to, ms){
    try{
      var start = audio.volume;
      var startT = Date.now();
      if(ms <= 0){ audio.volume = to; return; }
      function step(){
        var t = (Date.now() - startT) / ms;
        if(t >= 1){ audio.volume = to; return; }
        audio.volume = start + (to - start) * t;
        requestAnimationFrame(step);
      }
      requestAnimationFrame(step);
    }catch(e){}
  }

  // Start playback and unmute on first meaningful user interaction (click, touchstart, keydown, wheel, touchmove)
  function startOnGesture(){
    try{
      if(audio.muted){
        audio.muted = false;
        var target = 0.9;
        try{ audio.volume = 0;}catch(e){}
        saveState();
        audio.play().then(()=>{ _fadeVolume(target, 800); saveState(); }).catch(()=>{/* still blocked */});
      } else {
        audio.play().then(()=>{ saveState(); }).catch(()=>{/* still blocked */});
      }
    }catch(e){}
  }

  ['click','touchstart','keydown','wheel','touchmove','touchend','scroll'].forEach(ev => {
    window.addEventListener(ev, startOnGesture, { once: true, passive: true });
  });

  window.addEventListener('scroll', hidePrompt, { once: true, passive: true });

  tryAutoPlay();

  const CLIP_START = 0;
  const CLIP_DURATION = 30 * 60;
  const CLIP_END = CLIP_START + CLIP_DURATION;

  audio.addEventListener('timeupdate', function(){
    try{
      if(typeof audio.currentTime === 'number' && audio.currentTime >= CLIP_END){
        audio.pause();
        try{ audio.currentTime = CLIP_START;}catch(e){}
        saveState();
        _updateCtlIcon();
        return;
      }
    }catch(e){ }
    if(!audio._lastSaved || (Date.now() - audio._lastSaved) > 1000){
      audio._lastSaved = Date.now();
      saveState();
    }
  });

  window.addEventListener('pagehide', function(){ saveState(); });
  window.addEventListener('beforeunload', function(){ saveState(); });
  document.addEventListener('turbo:before-cache', function(){ saveState(); });

  if(state.playing){ tryAutoPlay(); }

    console.log('[AudioPlayer] Initialized (Turbo-aware). Src:', (audio && audio.src) ? audio.src : _audioSrc());
  });
})();</script>
</head>
<body>
  <audio id="site-audio" data-turbo-permanent src="/uploads/site-music.mp3" loop preload="auto" muted autoplay playsinline style="display:none"></audio>
  <script>
  (function(){
    function playOnGesture(){
      var a=document.getElementById('site-audio');
      if(a){
        try{ a.muted=false; a.play(); }catch(e){}
      }
    }
    ['scroll','click','keydown','touchstart'].forEach(ev=>
      window.addEventListener(ev, playOnGesture, {once:true,passive:true})
    );
  })();
  </script>
  <div id="particles-js"></div>
  <header>
    <button id="nav-toggle" class="nav-toggle" aria-controls="main-nav" aria-expanded="false">‚ò∞</button>
    <nav>
      <ul id="main-nav" class="nav-list">
        <li><a href="/">Home</a></li>
        <li><a href="/about">About</a></li>
        <li><a href="/books">Books</a></li>
        <li><a href="/blog">Blog</a></li>
        <li><a href="/contact">Contact</a></li>
        <li><a href="/email-list">Email List</a></li>
      </ul>
    </nav>
  </header>
  <main>
    <section class="hero">
      <h1>Noah B. Price</h1>
      <p>Author and Observer<br>of the Human Condition.</p>

      <p>The central misunderstanding of a human life<br>is the belief that it is lived forward.</p>

      <p>It is not.<br>It is stabilized backward.</p>

      <p>What gives a life its apparent direction is not intention or desire,<br>but the growing weight of what has already been accommodated.</p>

      <p>Each accommodation makes the next one easier,<br>until continuity itself becomes the primary value<br>and everything else is judged by whether it disrupts it.</p>

      <p>This is why people rarely feel coerced by their lives<br>even when they no longer recognize themselves inside them.</p>

      <p>The constraint does not arrive as force.</p>

      <p>It arrives as precedent.</p>

      <p>From this follows something rarely acknowledged.</p>

      <p>A person's future is not constrained by what they lack,<br>but by what they have already learned to live with.</p>

      <p>Tolerance becomes architecture.</p>

      <p>Endurance becomes structure.</p>

      <p>What once felt provisional quietly becomes load-bearing,<br>and the cost of revising it increases<br>with every day it remains unchallenged.</p>

      <p>Eventually, change stops presenting itself as possibility<br>and begins to appear only as threat.</p>

      <p>This is why insight so often feels vivid yet remains inert.</p>

      <p>Understanding arrives into a system optimized to absorb it without reorganization.</p>

      <p>Language expands, self-knowledge refines, explanation improves,<br>while the underlying arrangement remains untouched.</p>

      <p>The mind is allowed to move as long as the life does not.</p>

      <p>The work found here begins at the point where that arrangement is no longer treated as neutral.</p>

      <p>Where the difference between adaptation and authorship is no longer blurred.</p>

      <p>Where the question is no longer what one believes or intends,<br>but what one has already agreed to preserve simply by continuing.</p>

      <p>Nothing here promises transformation.</p>

      <p>It describes the conditions under which transformation becomes unavoidable.</p>
    </section>
    <section>
      <h2>Featured Work</h2>
      <p>Explore the Books</p>
      <p>Each work stands independently,<br>yet none exist in isolation.</p>
      <p>Together they form a sustained examination of consciousness,<br>moral responsibility, and the cost of self-deception<br>in a civilization that has normalized it.</p>

      <p>These are not stories written for distraction.</p>

      <p>They are inquiries shaped by lived experience,<br>disciplined thought, and uncompromising emotional clarity.</p>

      <p>Some challenge inherited belief.</p>

      <p>Some dismantle convenient narratives.</p>

      <p>Some confront the distance between what we claim to value<br>and how we actually live.</p>

      <p>All are written with the assumption that the reader<br>is capable of thinking deeply, questioning honestly,<br>and enduring truth without distortion.</p>
      <a href="/books" class="btn">Explore the Books</a>
      <a href="https://amazon.com" class="btn">Buy on Amazon</a>
    </section>
    <section>
      <h2>About the Author</h2>
      <p>A Brief Introduction</p>
      <p>‚ÄúThere comes a point when clarity<br>becomes heavier than comfort...<br><br>
I reached it.<br><br>
After that, speaking was no longer a choice.<br><br>
It was alignment.‚Äù - Noah B. Price</p>
      <a href="/about" class="btn">Read More About Me</a>
    </section>
    <section>
      <h2>From the Journal</h2>
      <p>Recent Writing</p>
      <p>The books are structured arguments.</p>
      <p>The journal is where thought unfolds in real time.</p>
      <p>Here I examine ideas before they are polished, question assumptions before they harden into belief, and trace the patterns shaping our culture while they are still forming.</p>
      <p>These entries are not afterthoughts.</p>
      <p>They are extensions of the same inquiry, written without insulation.</p>
      <p>If you want to understand not only what I conclude, but how I think, this is where you begin.</p>
      <a href="/blog" class="btn">Read the Journal</a>
    </section>
    <section>
      <h2>Stay Connected</h2>
      <p>Join the Mailing List</p>
      <p>The public writing is curated.</p>
      <p>The mailing list is direct.</p>
      <p>Here I share personal notes, developing ideas, and work that is not released elsewhere. It is a space for deeper examination, removed from algorithmic distortion and the demand for performance.</p>
      <p>If you value clarity over volume and substance over convenience, this is where the conversation continues.</p>
      <p>Only writing that justifies your time.</p>
      <form action="/subscribe" method="post">
        <input type="email" name="email" placeholder="Your Email" required>
        <button type="submit">Join the List</button>
      </form>
    </section>
  </main>
  <footer>
    <div>
      <h3>Stay Connected</h3>
      <p>Private notes and updates are shared through the mailing list.</p>
      <p><a href="/email-list">&rarr; Join the Mailing List</a></p>
      <p>Books by Noah B. Price are available on Amazon.</p>
      <p><a href="https://amazon.com">&rarr; Buy on Amazon</a></p>
    </div>
    <div>
      <h3>Legal</h3>
      <p><a href="/privacy">Privacy Policy</a></p>
      <p><a href="/terms">Terms of Use</a></p>
      <p><a href="/accessibility">Accessibility</a></p>
    </div>
    <p>&copy; 2026 Noah B. Price. All rights reserved.</p>
  </footer>
</body>
</html>